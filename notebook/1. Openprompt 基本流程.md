# Openprompt 基本流程

> In this scripts, you will learn 
>
> 1. how to use integrate huggingface datasets utilities into openprompt to enable prompt learning in diverse datasets.
> 1. How to instantiate a template using a template language
> 1. How does the template wrap the input example into a templated one.
> 1. How do we hide the PLM tokenization details behind and provide a simple tokenization
> 1. How do construct a verbalizer using one/many label words
> 1. How to train the prompt like a traditional Pretrained Model.

在这个脚本中，我们将学习

1. 如何使用将`huggingface`中的`datasets utilities`集成到`openprompt`中，

   以便在各种数据集中实现提示学习；

2. 如何使用模板语言实例化模板；

3. 模板如何将输入示例包装到模板中；

4. 我们如何隐藏PLM令牌化的详细步骤并提供简单的令牌化；

5. 如何使用单/多标签单词构建语言解释器；

6. 如何像传统的预训练模型一样训练提示模型。

## 1.  读取数据集合

使用`datasets`包读取原始数据集

```python
# load dataset
import os
from datasets import load_dataset, load_from_disk
os.chdir("/home/lhc/Projects/Openprompt-learner")  # 更换为项目路径
# raw_dataset = load_dataset('super_glue', 'cb', cache_dir="datasets/.cache/huggingface_datasets")  # 可以尝试直接使用网络数据
raw_dataset = load_from_disk("datasets/super_glue")  # 读取本地数据
print(raw_dataset['train'][0])
```

原始数据集示例：

```python
{'premise': 'It was a complex language. Not written down but handed down. One might say it was peeled down.',
 'hypothesis': 'the language was peeled down',
 'idx': 0,
 'label': 0}
```

使用`openprompt.data_utils` 将原始数据转化为输入样例：

```python
from openprompt.data_utils import InputExample

dataset = {}
for split in ['train', 'validation', 'test']:
    dataset[split] = []
    for data in raw_dataset[split]:
        input_example = InputExample(text_a = data['premise'], text_b = data['hypothesis'], label=int(data['label']), guid=data['idx'])
        dataset[split].append(input_example)
print(dataset['train'][0])
```

数据集示例

```python
{
  "guid": 0,
  "label": 0,
  "meta": {},
  "text_a": "It was a complex language. Not written down but handed down. One might say it was peeled down.",
  "text_b": "the language was peeled down",
  "tgt_text": null
}
```

## 2. 读取PLM

> You can load the plm related things provided by openprompt simply by calling：

 使用`openprompt.plms`包读取预训练语言模型和对应的分词器、模型配置、包装器，此处以`T5-base`为例：

 ```
 from openprompt.plms import load_plm
 plm, tokenizer, model_config, WrapperClass = load_plm("t5", "t5-base")
 ```

## 3. 构建模板